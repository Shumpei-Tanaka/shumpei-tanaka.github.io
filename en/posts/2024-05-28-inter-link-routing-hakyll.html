<!doctype html>
<html lang="en" class="has-navbar-fixed-top" style="scroll-padding-top: 70px;" data-theme="dark">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>S6T4 - to use inter link in md with modified Route by Hakyll</title>
        <link rel="stylesheet" href="../../css/bulma.css" />
        <link rel="stylesheet" href="../../css/syntax.css" />
        <script src="../../js/default.js"></script>
        <meta name="msapplication-square70x70logo" content="/favicons/site-tile-70x70.png">
        <meta name="msapplication-square150x150logo" content="/favicons/site-tile-150x150.png">
        <meta name="msapplication-wide310x150logo" content="/favicons/site-tile-310x150.png">
        <meta name="msapplication-square310x310logo" content="/favicons/site-tile-310x310.png">
        <meta name="msapplication-TileColor" content="#0078d7">
        <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../favicons/favicon.ico">
        <link rel="icon" type="image/vnd.microsoft.icon" href="../../favicons/favicon.ico">
        <link rel="apple-touch-icon" sizes="57x57" href="../../favicons/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="../../favicons/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="../../favicons/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="../../favicons/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="../../favicons/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="../../favicons/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="../../favicons/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="../../favicons/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="../../favicons/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" sizes="36x36" href="../../favicons/android-chrome-36x36.png">
        <link rel="icon" type="image/png" sizes="48x48" href="../../favicons/android-chrome-48x48.png">
        <link rel="icon" type="image/png" sizes="72x72" href="../../favicons/android-chrome-72x72.png">
        <link rel="icon" type="image/png" sizes="96x96" href="../../favicons/android-chrome-96x96.png">
        <link rel="icon" type="image/png" sizes="128x128" href="../../favicons/android-chrome-128x128.png">
        <link rel="icon" type="image/png" sizes="144x144" href="../../favicons/android-chrome-144x144.png">
        <link rel="icon" type="image/png" sizes="152x152" href="../../favicons/android-chrome-152x152.png">
        <link rel="icon" type="image/png" sizes="192x192" href="../../favicons/android-chrome-192x192.png">
        <link rel="icon" type="image/png" sizes="256x256" href="../../favicons/android-chrome-256x256.png">
        <link rel="icon" type="image/png" sizes="384x384" href="../../favicons/android-chrome-384x384.png">
        <link rel="icon" type="image/png" sizes="512x512" href="../../favicons/android-chrome-512x512.png">
        <link rel="icon" type="image/png" sizes="36x36" href="../../favicons/icon-36x36.png">
        <link rel="icon" type="image/png" sizes="48x48" href="../../favicons/icon-48x48.png">
        <link rel="icon" type="image/png" sizes="72x72" href="../../favicons/icon-72x72.png">
        <link rel="icon" type="image/png" sizes="96x96" href="../../favicons/icon-96x96.png">
        <link rel="icon" type="image/png" sizes="128x128" href="../../favicons/icon-128x128.png">
        <link rel="icon" type="image/png" sizes="144x144" href="../../favicons/icon-144x144.png">
        <link rel="icon" type="image/png" sizes="152x152" href="../../favicons/icon-152x152.png">
        <link rel="icon" type="image/png" sizes="160x160" href="../../favicons/icon-160x160.png">
        <link rel="icon" type="image/png" sizes="192x192" href="../../favicons/icon-192x192.png">
        <link rel="icon" type="image/png" sizes="196x196" href="../../favicons/icon-196x196.png">
        <link rel="icon" type="image/png" sizes="256x256" href="../../favicons/icon-256x256.png">
        <link rel="icon" type="image/png" sizes="384x384" href="../../favicons/icon-384x384.png">
        <link rel="icon" type="image/png" sizes="512x512" href="../../favicons/icon-512x512.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../../favicons/icon-16x16.png">
        <link rel="icon" type="image/png" sizes="24x24" href="../../favicons/icon-24x24.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../../favicons/icon-32x32.png">
        <link rel="manifest" href="../../favicons/manifest.json">
    </head>
    <body style="scroll-padding-top: 70px;">
            <header class="navbar has-background-primary-dark is-fixed-top" role="navigation" aria-label="main navigation">
                <div class="navbar-brand">
                    <a class="navbar-item" href="../../">
                        <span class="title is-1">
                            S6T4
                        </span>
                    </a>
                    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="mainnav">
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                        <span aria-hidden="true"></span>
                    </a>
                </div>
                <div id="mainnav" class="navbar-menu has-background-primary-dark">
                    <div class="navbar-start"> 
                        <a class="navbar-item is-size-4 has-text-info" href="../../">Home</a>
                        <a class="navbar-item is-size-4 has-text-info" href="../../archive.html">Archive</a>
                    </div>
                </div>
            </header>
        
        <div class="mt-4" align="right">
            <table class="table has-background-info-dark">
                <tbody>
                    <th class="is-vcentered is-centered">
                        lang
                    </th>
                    
                        <td>
                            <a class="button is-link" href="../../en/posts/2024-05-28-inter-link-routing-hakyll.html">en</a>
                        </td>
                    
                        <td>
                            <a class="button is-link" href="../../jp/posts/2024-05-28-inter-link-routing-hakyll.html">jp</a>
                        </td>
                    
                </tbody>
            </table>
        </div>
        
        <main class="container is-fluid mt-5">
            <div class="content">
                <h2>to use inter link in md with modified Route by Hakyll</h2>
                <div class="container my-5">
    <table class="table">
        <thead>
            <tr>
                <th>
                    Published
                </th>
                <th>
                    Last Update 
                </th>
                
                    <th>
                        author
                    </th>
                
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    2024/05/28
                </td>  
                <td>
                    
                    2024/05/28
                    
                </td>
                
                    <td>
                        Shumpei Tanaka
                    </td>
                
            </tr>
        </tbody>
    </table>

    

    

</div>
<article class="container">
    <p>links in output html are not updated automatically via Hakyllâ€™s pandoc compiler with modified route.</p>
<p>For this reason, it is necessary to manually rewrite the link in markdown.</p>
<p><code>withUrls</code> is a function in Hakyll can apply <code>String-&gt;String</code> convert in each URLs.</p>
<p>so it can be used to create a specific parser.</p>
<p>below is usage example.</p>
<ul>
<li><code>parseInnerLinks</code>: apply <code>parseInnerLink</code> each URLs by <code>withUrls</code>.</li>
<li><code>parseInnerLink</code>: apply <code>parsePostLink</code> only URL has prefix <code>/posts</code></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ot">parseInnerLinks ::</span> <span class="dt">Item</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>parseInnerLinks <span class="ot">=</span> <span class="fu">pure</span> <span class="op">.</span> <span class="fu">fmap</span> (withUrls parseInnerLink)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ot">parseInnerLink ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>parseInnerLink url</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> isExternal url <span class="ot">=</span> url</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="st">&quot;/posts&quot;</span> <span class="ot">`L.isPrefixOf`</span> url <span class="ot">=</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        parsePostLink url</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        url</span></code></pre></div>
<ul>
<li><code>parsePostLink</code>: it convert URL which include <code>#</code> (section link).
convert URL before <code>#</code> and re-concat URL after <code>#</code>.</li>
<li><code>convPostUrl</code>: apply <code>String-&gt;String</code> convert in same as used <code>Route</code>
delete <code>/</code> which head of URL by <code>tail</code> to get <code>Filepath</code>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">parsePostLink ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>parsePostLink url <span class="ot">=</span> <span class="kw">case</span> <span class="fu">map</span> T.unpack <span class="op">.</span> T.splitOn <span class="st">&quot;#&quot;</span> <span class="op">$</span> T.pack url <span class="kw">of</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    [base] <span class="ot">-&gt;</span> addHtml <span class="op">.</span> convPostUrl <span class="op">$</span> base</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    [base, section] <span class="ot">-&gt;</span> (<span class="op">++</span> section) <span class="op">.</span> (<span class="op">++</span> <span class="st">&quot;#&quot;</span>) <span class="op">.</span> addHtml <span class="op">.</span> convPostUrl <span class="op">$</span> base</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ot">convPostUrl ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>convPostUrl url <span class="ot">=</span> (<span class="op">++</span>) <span class="st">&quot;/&quot;</span> <span class="op">.</span> getLangPath <span class="op">.</span> fromFilePath <span class="op">$</span> <span class="fu">tail</span> url</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="ot">addHtml ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>addHtml <span class="ot">=</span> (<span class="op">++</span> <span class="st">&quot;.html&quot;</span>)</span></code></pre></div>
<p>below is example of usage <code>parseInnerLinks</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pandocCompiler</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/post.html&quot;</span> postCtx</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> postCtx</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&gt;&gt;=</span> parseInnerLinks</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">&gt;&gt;=</span> relativizeUrls</span></code></pre></div>
</article>

<div class="card mt-5">
    <div class="card-header">
        <p class="card-header-title title is-4">Say thank you</p>
    </div>
    <div class="card-content">
        <div class="content">
            If this post helps you, I'd be glad to get your support via the link below.
        </div>
        <a href="https://paypal.me/s6tanaka">
    <img alt="paypal.me Badge" src="https://img.shields.io/badge/paypal.me-s6tanaka-white?style=flat-squere:badgeContent&logo=paypal">
</a>
<a href="https://www.buymeacoffee.com/s6tanaka">
    <img alt="paypal.me Badge" src="https://img.shields.io/badge/buy_me_a_coffee-s6tanaka-white?style=flat-squere:badgeContent&logo=buymeacoffee&logocolor=#FFDD00">
</a>
    </div>
</div>

<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
//    this.page.url = "/en/posts/2024-05-28-inter-link-routing-hakyll.html";
//    this.page.identifier = PAGE_IDENTIFIER;
    this.language = "en";
    };
    
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://s6t4.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


            </div>
        </main>

        <footer class="footer">
            <div class="content has-text-centered">
                
                    <a href="../../">
                
                    back to home
                </a>
                <p>
                    Site proudly generated by
                    <a href="http://jaspervdj.be/hakyll">Hakyll</a>
                    ,
                    <a href="https://bulma.io/">Bulma</a>
                </p>
            </div>
        </footer>
    </body>
</html>
